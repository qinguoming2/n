<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta name="generator" content="Quarkdown">
    <meta charset="UTF-8">
    <meta name="description" content="a blog demo">
    <meta name="author" content="qinguoming">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="quarkdown:root-path" content="..">
    <title>blog</title>
    <script src="../script/quarkdown.js"></script>
    <script>const capabilities = window.quarkdownCapabilities</script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="../theme/theme.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js"></script>
    <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
    <link href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css" rel="stylesheet">
    <script>capabilities.code = true;</script>
    <style>@font-face { font-family: '-503305824'; src: local('Consolas'); }

body {
    --qd-code-custom-font: '-503305824';
    --qd-main-font-size: 12.0pt;}

body.quarkdown-plain.quarkdown-plain,
body.quarkdown-docs.quarkdown-docs {
}

body.quarkdown-slides.quarkdown-slides .reveal {
}

@page {
    size: auto auto;
    margin: 0;}

p {
}</style>
    <script>prepare(new PlainDocument());</script>
<template id="sidebar-template"><nav class="sidebar" role="doc-toc"><ol><li data-target-id="abaqus-输出总体刚度矩阵" data-depth="1"><a href="#abaqus-输出总体刚度矩阵">Abaqus 输出总体刚度矩阵</a><ol><li data-target-id="输出总体刚度矩阵" data-depth="2"><a href="#输出总体刚度矩阵">输出总体刚度矩阵</a><ol><li data-target-id="指定输出什么矩阵" data-depth="3"><a href="#指定输出什么矩阵">指定输出什么矩阵</a></li><li data-target-id="是否输出单元形式矩阵" data-depth="3"><a href="#是否输出单元形式矩阵">是否输出单元形式矩阵</a></li><li data-target-id="为部分模型生成矩阵" data-depth="3"><a href="#为部分模型生成矩阵">为部分模型生成矩阵</a></li><li data-target-id="频率相关材料mpc约束公共点等" data-depth="3"><a href="#频率相关材料mpc约束公共点等">频率相关材料/MPC约束/公共点等</a></li><li data-target-id="关于初始条件边界条件载荷预定义场材料选项单元" data-depth="3"><a href="#关于初始条件边界条件载荷预定义场材料选项单元">关于初始条件/边界条件/载荷/预定义场/材料选项/单元</a></li><li data-target-id="输出矩阵的格式" data-depth="3"><a href="#输出矩阵的格式">输出矩阵的格式</a></li></ol></li><li data-target-id="template-input-file" data-depth="2"><a href="#template-input-file">Template input file</a><ol><li data-target-id="参考资料" data-depth="3"><a href="#参考资料">参考资料</a></li></ol></li></ol></li></ol></nav>
</template>  </head>
  <body class="quarkdown quarkdown-plain">
    <aside class="margin-area" id="margin-area-left"></aside>
    <main><div class="container fullwidth" style="justify-items: end; text-align: end;"><p><a href="https://blog.qgm1702.top/">返回 主页</a></p></div><div class="page-break" data-hidden=""></div><h1 id="table-of-contents">目录</h1><nav role="table-of-contents" data-role="table-of-contents"><ol><li data-target-id="abaqus-输出总体刚度矩阵" data-depth="1"><a href="#abaqus-输出总体刚度矩阵">Abaqus 输出总体刚度矩阵</a><ol><li data-target-id="输出总体刚度矩阵" data-depth="2"><a href="#输出总体刚度矩阵">输出总体刚度矩阵</a><ol><li data-target-id="指定输出什么矩阵" data-depth="3"><a href="#指定输出什么矩阵">指定输出什么矩阵</a></li><li data-target-id="是否输出单元形式矩阵" data-depth="3"><a href="#是否输出单元形式矩阵">是否输出单元形式矩阵</a></li><li data-target-id="为部分模型生成矩阵" data-depth="3"><a href="#为部分模型生成矩阵">为部分模型生成矩阵</a></li><li data-target-id="频率相关材料mpc约束公共点等" data-depth="3"><a href="#频率相关材料mpc约束公共点等">频率相关材料/MPC约束/公共点等</a></li><li data-target-id="关于初始条件边界条件载荷预定义场材料选项单元" data-depth="3"><a href="#关于初始条件边界条件载荷预定义场材料选项单元">关于初始条件/边界条件/载荷/预定义场/材料选项/单元</a></li><li data-target-id="输出矩阵的格式" data-depth="3"><a href="#输出矩阵的格式">输出矩阵的格式</a></li></ol></li><li data-target-id="template-input-file" data-depth="2"><a href="#template-input-file">Template input file</a><ol><li data-target-id="参考资料" data-depth="3"><a href="#参考资料">参考资料</a></li></ol></li></ol></li></ol></nav><p></p><div class="page-break" data-hidden=""></div><h1 id="abaqus-输出总体刚度矩阵">Abaqus 输出总体刚度矩阵</h1><p>abaqus 可以输出模型的刚度/质量/阻尼/载荷矩阵等:</p><ul><li>输出单元刚度矩阵<ul><li>输出范围可以是一个单元,也可以是多个单元</li></ul></li><li>输出总体刚度矩阵<ul><li>输出的数据是整个模型的刚度矩阵,或者是某一特定区域的总体刚度矩阵,可以考虑MPC约束,声学等效应.</li></ul></li></ul><h2 id="输出总体刚度矩阵">输出总体刚度矩阵</h2><p>abaqus输出总体刚度矩阵主要用到Matrix Gernerate分析步,关键字为:<span class="codespan-content"><code>*MATRIX GENERATE</code></span>.</p><ol><li>是线性摄动过程;</li><li>如果分析中包含非线性几何效应,则包括由于预载荷和初始条件引起的初始应力和负载刚度效应;</li><li>对有限元模型进行数学抽象,根据网格和材料信息,通过生成全局或单元矩阵表示刚度,质量,粘性阻尼,结构阻尼和模型中的载荷矢量;</li><li>可以将矩阵数据输出到文本文件中,或二进制文件sim</li></ol><p>matrix generation procedure是一个线性摄动过程,所以<strong>输出的矩阵都是基于前面所有分析步结束后的状态时间点</strong>.另外,abaqus也允许在matrix generation procedure中设定新的边界条件,加载,预定义场等.(<strong>这时输出的矩阵是基于Matrix Generation procedure结束后的状态.</strong>)</p><p>abaqus 会使用SIM(高性能数据库)生成矩阵,并把矩阵数据存在<span class="codespan-content"><code>jobname_Xn.sim</code></span>文件中.</p><blockquote><p>jobname is the name of job, and n is the number of the Abaqus step that generates the matrices.</p></blockquote><h3 id="指定输出什么矩阵">指定输出什么矩阵</h3><p>以下关键字告诉abaqus要输出:刚度矩阵,质量矩阵,粘性阻尼矩阵,结构阻尼矩阵和模型中的载荷矩阵.</p><pre><code class="language-shell">*MATRIX GENERATE, STIFFNESS, MASS, VISCOUS DAMPING, STRUCTURE DAMPING, LOAD</code></pre><p>注意的是,<strong>LOAD MATRIX是根据matrix generation step中定义的load case生成的nodal load matrix</strong>.一个load case 可以包括 distributed loads, concentrated nodal loads, thermal expansion, and load cases defined for any substructures that may be used as part of the model.</p><h3 id="是否输出单元形式矩阵">是否输出单元形式矩阵</h3><p>默认情况下生成的矩阵是全局装配形式的,已经由局部单元矩阵和matrix input data 组装完成.但abaqus 提供了一个选项,可以申城 element-by-element form的全局矩阵.**Instead of global (assembled) matrices, local element matrices are generated.**开启这个option后,abaqus在生成矩阵过程中会忽略matrix input data.</p><pre><code class="language-shell">*MATRIX GENERATE, ELEMENT BY ELEMENT</code></pre><h3 id="为部分模型生成矩阵">为部分模型生成矩阵</h3><p>abaqus 默认会生成整个模型的矩阵,但也可以只生成部分模型的矩阵.</p><pre><code class="language-shell">MATRIX GENERATE, ELSET=element set name</code></pre><p>默认下,abaqus生成矩阵会考虑matrix input data 和finite element model的贡献. source 选项可以指定.</p><pre><code class="language-shell">** default
*MATRIX GENERATE, SOURCE=ALL 

**including only contributions from the finite elements
*MATRIX GENERATE, SOURCE=ELEMENTS

**including only contributions from the matrix input data
*MATRIX GENERATE, SOURCE=MATRIX INPUT </code></pre><p>默认情况下,abaqus会为模型的结构部分和声学部分生成矩阵.这也是可以控制的,但abaqus/standard不支持在matrix usage model中生成包含声学自由度的矩阵.详情可见<a href="https://abaqus-docs.mit.edu/2017/English/SIMACAEANLRefMap/simaanl-c-definingmatrices.htm#simaanl-c-definingmatrices"> Using matrices</a></p><pre><code class="language-shell">**(default)
**generate matrices for the structural and acoustic parts of the model
*MATRIX GENERATE, FIELD=ALL 

**generate matrices for the structural part of the model only
*MATRIX GENERATE, FIELD=STRUCTURAL 

**generate matrices for the acoustic part of the model only
*MATRIX GENERATE, FIELD=ACOUSTIC </code></pre><h3 id="频率相关材料mpc约束公共点等">频率相关材料/MPC约束/公共点等</h3><p>如果在材料属性中定义了频率相关的材料行为,abaqus生成矩阵时<strong>可以在指定频率计算材料属性</strong>,默认设置是在0Hz处计算材料属性,并且不考虑频率域粘弹性的贡献.</p><pre><code class="language-shell">*MATRIX GENERATE, PROPERTY EVALUATION=frequency</code></pre><p>默认情况下考虑MPC约束的贡献,但abaqus生成的矩阵只包括独立节点的自由度,受约束节点的自由度忽略了.</p><pre><code class="language-shell">** default
**generate the matrices with applied multipoint constraints
*MATRIX GENERATE, MPC=YES 

** skip the multipoint constraints during the matrix generation
*MATRIX GENERATE, MPC=NO </code></pre><blockquote><p>关于公共节点,我也不清楚,有待进一步研究.</p></blockquote><h3 id="关于初始条件边界条件载荷预定义场材料选项单元">关于初始条件/边界条件/载荷/预定义场/材料选项/单元</h3><blockquote><p>只写重要的结论,详细去看文档</p></blockquote><ul><li>initial conditions</li></ul><p>矩阵生成是一个线性摄动过程.因此,矩阵生成步骤的初始状态就是最后一个一般分析步结束时模型的状态.</p><ul><li>Boundary conditions</li></ul><p>在matrix generation step中,可以定义新的边界条件,但不会后续的general analysis step中使用(除非被重新定义)</p><ul><li>Loads</li></ul><p>在matrix generation step中,所有类型的LOADs都可以用在load case中,但不会后续的general analysis step中使用(除非被重新定义)</p><ul><li>Predefined fields</li></ul><p>All types of predefined fields can be specified in a matrix generation procedure.同样,这些字段不会被后续的general analysis step中使用(除非被重新定义)</p><ul><li>Material options</li></ul><p>能够用在Standard的材料选项,都可以用在这个分析步</p><ul><li>elements</li></ul><p>能够用在Standard的单元类型,都可以用在这个分析步.但是需要注意的是:</p><p>Solid continuum infinite elements (CIN-type elements) 在静力,动力分析中有不同的formula.因此如果模型有这种单元,需要指定使用哪种formula.</p><pre><code class="language-shell">** select the dynamic formulation for solid infinite elements
*MATRIX GENERATE, SOLID INFINITE FORMULATION=DYNAMIC

**select the static formulation for solid infinite elements
*MATRIX GENERATE, SOLID INFINITE FORMULATION=STATIC</code></pre><h3 id="输出矩阵的格式">输出矩阵的格式</h3><p>使用<span class="codespan-content"><code>*MATRIX OUTPUT</code></span>命令可以指定输出到文件的矩阵类型.</p><pre><code class="language-shell">** Use the following option to output the stiffness matrix
*MATRIX OUTPUT, STIFFNESS

**Use the following option to output the mass matrix:
*MATRIX OUTPUT, MASS

**Use the following option to output the viscous damping matrix:
*MATRIX OUTPUT, VISCOUS DAMPING

**Use the following option to output the structural damping matrix:
*MATRIX OUTPUT, STRUCTURAL DAMPING

**Use the following option to output the load matrix:
*MATRIX OUTPUT, LOAD</code></pre><p>abaqus支持输出矩阵到xx.sim文件和xx.mtx文件中,后者是文本文件,可以用文本编辑器打开查看.矩阵从xx.sim输出到xx.mtx时文件名称为: <span class="codespan-content"><code>jobname_matrixN.mtx</code></span>,其中N是matrix generation step的编号,matrix是表示矩阵类型的四个字母标识符.</p><figure><img src="media/2026433-20240618163630589-1810529456@1864074517.png" alt="img" /></figure><p>abaqus 输出的文件内容格式有6种(后三种暂时用不到,不写):</p><ul><li>Matrix input text format</li></ul><p>这是默认的文件格式, 使用和STANDRAD相同的矩阵定义技术.这种格式不会将Abaqus node labels转换,负数或0可能作为internal node labels输出到文件中.</p><pre><code class="language-shell">*MATRIX OUTPUT, FORMAT=MATRIX INPUT</code></pre><h4 id="format-of-the-operator-matrix">Format of the operator matrix</h4><p>ABAQUS会将将稀疏矩阵数据转换成一系列逗号分隔的列表写入文本文件.在刚度,质量,阻尼矩阵文件中,一行会有5项数据,分别是:Row node label, Degree of freedom for row node,Column node label,Degree of freedom for column node,Matrix entry.</p><pre><code class="language-shell">&lt;!-- Example of matrix input text format --&gt;
&lt;!-- 这是twoElem_outMatrix_STIF1.mtx文件的部分内容 --&gt;
1,1, 1,1,  7.966023675518204e+05
1,2, 1,1,  2.524038461538461e+05
1,3, 1,1, -4.574819711538461e+05
2,1, 1,1,  5.754108328979316e+05
2,2, 1,1, -5.048076923076921e+04
2,3, 1,1, -4.574819711538461e+05
3,1, 1,1,  8.216258397551760e+04
3,2, 1,1,  2.524038461538461e+05
3,3, 1,1,  9.149639423076922e+04
4,1, 1,1, -1.319053129612497e+05
4,2, 1,1, -5.048076923076921e+04
4,3, 1,1,  9.149639423076922e+04
5,1, 1,1,  1.301244035319694e+05
5,2, 1,1,  5.048076923076919e+04
5,3, 1,1, -9.149639423076922e+04
6,1, 1,1, -8.394349340479798e+04</code></pre><h4 id="format-of-the-load-matrix">Format of the load matrix</h4><p>Nonzero entries in load matrices, which represent right-hand-side vector data, are written to the text file as a comma-separated list .每一行数据有3项: Node label,Degree of freedom,Right-hand-side vector entry</p><p>The format of the load vectors and heading labels是基于关键字的,每一个load vector使用下面 的heading来标识load的实部虚部:</p><pre><code class="language-shell">*CLOAD, REAL
*CLOAD, IMAGINARY</code></pre><p>如果matrix generation step中定义多个load case,在文本文件中,每个load case的load vector会用如下的标识来标记:</p><pre><code class="language-shell">*LOAD CASE
…
*END LOAD CASE</code></pre><ul><li>Labeling text format</li></ul><p>这种format和matrix input text format类似,但唯一不同的就是: 内部Abaqus节点标签被转换成Abaqus矩阵输入数据可以接受的大正数.如果生成的矩阵被用来standard分析,那么这种format内所有的节点label都会被认为是用户自定义的节点.</p><pre><code class="language-shell">*MATRIX OUTPUT, FORMAT=LABELS</code></pre><ul><li>Coordinate text format</li></ul><p>这种format直观,而且容易输入到其他数学软件.文件中的每一行对应于一个矩阵项,每一行有3个值: 矩阵的行号,列号,矩阵值.并且这是已经组装完成的矩阵</p><pre><code class="language-shell">&lt;!-- Example of Coordinate text format --&gt;
&lt;!-- 这是twoElem_outMatrix_STIF1.mtx文件的部分内容 --&gt;
1 1  7.966023675518204e+05
1 2  2.524038461538461e+05
2 1  2.524038461538461e+05
1 3 -4.574819711538461e+05
3 1 -4.574819711538461e+05
1 4  5.754108328979316e+05
4 1  5.754108328979316e+05
1 5 -5.048076923076921e+04
5 1 -5.048076923076921e+04
1 6 -4.574819711538461e+05
6 1 -4.574819711538461e+05
1 7  8.216258397551760e+04
7 1  8.216258397551760e+04
1 8  2.524038461538461e+05
8 1  2.524038461538461e+05
1 9  9.149639423076922e+04
9 1  9.149639423076922e+04
1 10 -1.319053129612497e+05
10 1 -1.319053129612497e+05
1 11 -5.048076923076921e+04</code></pre><p>对于load matrix,每一行有2项:Equation (row) number,Right-hand-side vector entry</p><p>Commented load case options are written to the output file to indicate the load cases</p><pre><code class="language-shell">*MATRIX OUTPUT, FORMAT=COORDINATE</code></pre><h2 id="template-input-file">Template input file</h2><pre><code class="language-shell">*Heading
** Job name: twoElem_outMatrix Model name: Model-oneELEM
** Generated by: Abaqus/CAE 2023
*Preprint, echo=NO, model=NO, history=NO, contact=NO
**
** PARTS
**
*Part, name=Part-1
*Node
      1,        -37.5,         -30.,          20.
      2,        -37.5,         6.25,          20.
      3,        -37.5,         -30.,           0.
      4,        -37.5,         6.25,           0.
      5,         1.25,         -30.,          20.
      6,         1.25,         6.25,          20.
      7,         1.25,         -30.,           0.
      8,         1.25,         6.25,           0.
      9,          40.,         -30.,          20.
     10,          40.,         6.25,          20.
     11,          40.,         -30.,           0.
     12,          40.,         6.25,           0.
*Element, type=C3D8R
1,  5,  6,  8,  7,  1,  2,  4,  3
2,  9, 10, 12, 11,  5,  6,  8,  7
*Nset, nset=Set-3, generate
  1,  12,   1
*Elset, elset=Set-3
 1, 2
** Section: Section-1
*Solid Section, elset=Set-3, material=steel
,
*End Part
**  
**
** ASSEMBLY
**
*Assembly, name=Assembly
**  
*Instance, name=Part-1-1, part=Part-1
*End Instance
**  
*Nset, nset=Set-1, instance=Part-1-1, generate
  9,  12,   1
*Elset, elset=Set-1, instance=Part-1-1
 2,
*End Assembly
** 
** MATERIALS
** 
*Material, name=steel
*Density
 1.6e-09,
*Elastic
210000., 0.3
** ----------------------------------------------------------------
** 
** STEP: Step-1
** 
*Step
*MATRIX GENERATE, STIFFNESS,MASS,LOAD
*MATRIX OUTPUT, STIFFNESS, MASS, LOAD, FORMAT=COORDINATE
** 
** BOUNDARY CONDITIONS
** 
** Name: BC-1 Type: Symmetry/Antisymmetry/Encastre
*Boundary
Set-1, ENCASTRE
** 
** OUTPUT REQUESTS
** 
** 
** FIELD OUTPUT: F-Output-1
** 
** *Output, field, variable=PRESELECT
** ** 
** ** HISTORY OUTPUT: H-Output-1
** ** 
** *Output, history, variable=PRESELECT
*End Step
</code></pre><ul><li>DMIG format</li><li>User element format</li><li>Outputting matrices in element-by-element form</li></ul><h3 id="参考资料">参考资料</h3><ul><li><a href="https://abaqus-docs.mit.edu/2017/English/SIMACAEANLRefMap/simaanl-c-mtxgenerationperturbation.htm#simaanl-c-mtxgenerationperturbation-t-icsect1">Generating matrices</a></li><li><a href="https://abaqus-docs.mit.edu/2017/English/SIMACAEANLRefMap/simaanl-c-definingmatrices.htm#simaanl-c-definingmatrices-t-WhatIsAMatrixInAS-sma-topic1">Using matrices</a></li><li><a href="https://abaqus-docs.mit.edu/2017/English/SIMACAEKEYRefMap/simakey-r-matrixgenerate.htm#simakey-r-matrixgenerate">MATRIX GENERATE</a></li></ul><div class="container fullwidth" style="justify-items: end; text-align: end;"><p><a href="https://blog.qgm1702.top/">返回 主页</a></p></div></main>
    <aside class="margin-area" id="margin-area-right"></aside>
  </body>
</html>
