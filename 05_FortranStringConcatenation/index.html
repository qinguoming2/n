<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta name="generator" content="Quarkdown">
    <meta charset="UTF-8">
    <meta name="description" content="a blog demo">
    <meta name="author" content="qinguoming">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="quarkdown:root-path" content="..">
    <title>blog</title>
    <script src="../script/quarkdown.js"></script>
    <script>const capabilities = window.quarkdownCapabilities</script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="../theme/theme.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js"></script>
    <script src="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.js"></script>
    <link href="https://unpkg.com/highlightjs-copy/dist/highlightjs-copy.min.css" rel="stylesheet">
    <script>capabilities.code = true;</script>
    <style>@font-face { font-family: '-503305824'; src: local('Consolas'); }

body {
    --qd-code-custom-font: '-503305824';
    --qd-main-font-size: 12.0pt;}

body.quarkdown-plain.quarkdown-plain,
body.quarkdown-docs.quarkdown-docs {
}

body.quarkdown-slides.quarkdown-slides .reveal {
}

@page {
    size: auto auto;
    margin: 0;}

p {
}</style>
    <script>prepare(new PlainDocument());</script>
<template id="sidebar-template"><nav class="sidebar" role="doc-toc"><ol><li data-target-id="modern-fortran-字符串拼接" data-depth="1"><a href="#modern-fortran-字符串拼接">Modern Fortran 字符串拼接</a><ol><li data-target-id="_1-基本字符串拼接-操作符" data-depth="2"><a href="#_1-基本字符串拼接-操作符">1. 基本字符串拼接(// 操作符)</a></li><li data-target-id="_2-动态调整字符串长度adjustl-和-trim" data-depth="2"><a href="#_2-动态调整字符串长度adjustl-和-trim">2. 动态调整字符串长度(adjustl 和 trim)</a></li><li data-target-id="_3-格式化拼接write-到内部文件" data-depth="2"><a href="#_3-格式化拼接write-到内部文件">3. 格式化拼接(write 到内部文件)</a></li><li data-target-id="_4-字符串数组拼接do-循环或-implied-do" data-depth="2"><a href="#_4-字符串数组拼接do-循环或-implied-do">4. 字符串数组拼接(do 循环或 implied do)</a></li><li data-target-id="_5-处理长字符串避免截断" data-depth="2"><a href="#_5-处理长字符串避免截断">5. 处理长字符串(避免截断)</a></li><li data-target-id="总结" data-depth="2"><a href="#总结">总结</a></li></ol></li></ol></nav>
</template>  </head>
  <body class="quarkdown quarkdown-plain">
    <aside class="margin-area" id="margin-area-left"></aside>
    <main><div class="container fullwidth" style="justify-items: end; text-align: end;"><p><a href="https://qinguoming.pages.dev/">返回 主页</a></p></div><div class="page-break" data-hidden=""></div><h1 id="table-of-contents">目录</h1><nav role="table-of-contents" data-role="table-of-contents"><ol><li data-target-id="modern-fortran-字符串拼接" data-depth="1"><a href="#modern-fortran-字符串拼接">Modern Fortran 字符串拼接</a><ol><li data-target-id="_1-基本字符串拼接-操作符" data-depth="2"><a href="#_1-基本字符串拼接-操作符">1. 基本字符串拼接(// 操作符)</a></li><li data-target-id="_2-动态调整字符串长度adjustl-和-trim" data-depth="2"><a href="#_2-动态调整字符串长度adjustl-和-trim">2. 动态调整字符串长度(adjustl 和 trim)</a></li><li data-target-id="_3-格式化拼接write-到内部文件" data-depth="2"><a href="#_3-格式化拼接write-到内部文件">3. 格式化拼接(write 到内部文件)</a></li><li data-target-id="_4-字符串数组拼接do-循环或-implied-do" data-depth="2"><a href="#_4-字符串数组拼接do-循环或-implied-do">4. 字符串数组拼接(do 循环或 implied do)</a></li><li data-target-id="_5-处理长字符串避免截断" data-depth="2"><a href="#_5-处理长字符串避免截断">5. 处理长字符串(避免截断)</a></li><li data-target-id="总结" data-depth="2"><a href="#总结">总结</a></li></ol></li></ol></nav><div class="page-break" data-hidden=""></div><h1 id="modern-fortran-字符串拼接">Modern Fortran 字符串拼接</h1><p>在 Fortran 2008 中,字符串拼接(String Concatenation)主要通过 <span class="codespan-content"><code>//</code></span> 操作符 实现,同时也支持 动态字符串处理 和 格式化拼接。以下是详细的方法说明和代码示例,包含关键注释。</p><h2 id="_1-基本字符串拼接-操作符">1. 基本字符串拼接(<span class="codespan-content"><code>//</code></span> 操作符)</h2><pre><code class="language-shell">program basic_concat
    implicit none
    character(len=10) :: str1 = &quot;Hello&quot;
    character(len=6)  :: str2 = &quot;World&quot;
    character(len=20) :: result

    ! 使用 // 拼接字符串
    result = str1 // &quot; &quot; // str2  ! &quot;Hello World&quot;

    print *, &quot;Concatenated: &quot;, trim(result)  ! trim 去除尾部空格
end program basic_concat</code></pre><table><thead><tr><th>代码部分</th><th>说明</th></tr></thead><tbody><tr><td><span class="codespan-content"><code>str1 // str2</code></span></td><td>拼接两个字符串</td></tr><tr><td><span class="codespan-content"><code>trim(result)</code></span></td><td>移除结果字符串的尾部空格(<span class="codespan-content"><code>character(len=20)</code></span> 会填充空格)</td></tr></tbody></table><h2 id="_2-动态调整字符串长度adjustl-和-trim">2. 动态调整字符串长度(<span class="codespan-content"><code>adjustl</code></span> 和 <span class="codespan-content"><code>trim</code></span>)</h2><p>Fortran 的字符串是固定长度的,拼接时需注意长度分配。</p><pre><code class="language-shell">program dynamic_adjust
    implicit none
    character(len=:), allocatable :: dynamic_str  ! 可分配字符串
    character(len=10) :: str1 = &quot;Hello&quot;
    character(len=6)  :: str2 = &quot;Fortran&quot;

    ! 动态分配足够空间
    dynamic_str = trim(str1) // &quot; &quot; // trim(str2)  ! 自动分配长度

    print *, &quot;Dynamic String: &quot;, dynamic_str
end program dynamic_adjust</code></pre><table><thead><tr><th>代码部分</th><th>说明</th></tr></thead><tbody><tr><td><span class="codespan-content"><code>character(len=:), allocatable</code></span></td><td>声明可分配字符串(长度运行时确定)</td></tr><tr><td><span class="codespan-content"><code>trim(str1)</code></span></td><td>去除尾部空格避免多余填充</td></tr></tbody></table><h2 id="_3-格式化拼接write-到内部文件">3. 格式化拼接(<span class="codespan-content"><code>write</code></span> 到内部文件)</h2><p>适用于需要控制格式的复杂拼接(如数字转字符串后拼接)。</p><pre><code class="language-shell">program formatted_concat
    implicit none
    integer :: age = 30
    real    :: height = 1.75
    character(len=50) :: info

    ! 将数值和字符串格式化拼接
    write(info, &#39;(A, I2, A, F4.2, A)&#39;) &quot;Age: &quot;, age, &quot;, Height: &quot;, height, &quot; meters&quot;

    print *, trim(info)  ! 输出: &quot;Age: 30, Height: 1.75 meters&quot;
end program formatted_concat</code></pre><table><thead><tr><th>格式符</th><th>作用</th></tr></thead><tbody><tr><td><span class="codespan-content"><code>A</code></span></td><td>字符串</td></tr><tr><td><span class="codespan-content"><code>I2</code></span></td><td>2位宽整数</td></tr><tr><td><span class="codespan-content"><code>F4.2</code></span></td><td>4位宽浮点数(2位小数)</td></tr></tbody></table><h2 id="_4-字符串数组拼接do-循环或-implied-do">4. 字符串数组拼接(<span class="codespan-content"><code>do</code></span> 循环或 <span class="codespan-content"><code>implied do</code></span>)</h2><pre><code class="language-shell">program array_concat
    implicit none
    character(len=10), dimension(3) :: words = [&quot;Fortran &quot;, &quot;is    &quot;, &quot;awesome&quot;]
    character(len=50) :: sentence
    integer :: i

    ! 方法1: 使用循环拼接
    sentence = &quot;&quot;
    do i = 1, 3
        sentence = trim(sentence) // &quot; &quot; // trim(words(i))
    end do
    print *, &quot;Loop Result: &quot;, trim(sentence)

    ! 方法2: 使用隐式循环(需提前分配足够空间)
    write(sentence, *) (trim(words(i)), &quot; &quot;, i=1, 3)
    print *, &quot;Implied DO Result: &quot;, adjustl(sentence)  ! 左对齐
end program array_concat</code></pre><table><thead><tr><th>代码部分</th><th>说明</th></tr></thead><tbody><tr><td><span class="codespan-content"><code>trim(words(i))</code></span></td><td>去除每个单词的尾部空格</td></tr><tr><td><span class="codespan-content"><code>adjustl(sentence)</code></span></td><td>左对齐结果字符串</td></tr></tbody></table><h2 id="_5-处理长字符串避免截断">5. 处理长字符串(避免截断)</h2><p>如果拼接结果可能超出现有字符串长度,需预先分配足够空间。</p><pre><code class="language-shell">program long_string
    implicit none
    character(len=:), allocatable :: long_str
    character(len=5) :: part1 = &quot;Hello&quot;
    character(len=7) :: part2 = &quot;Fortran&quot;

    ! 分配足够空间(手动计算长度)
    allocate(character(len=len_trim(part1) + len_trim(part2) + 1) :: long_str)
    long_str = trim(part1) // &quot; &quot; // trim(part2)

    print *, &quot;Long String: &quot;, long_str
    deallocate(long_str)
end program long_string</code></pre><table><thead><tr><th>函数</th><th>说明</th></tr></thead><tbody><tr><td><span class="codespan-content"><code>len_trim(str)</code></span></td><td>返回字符串有效长度(不含尾部空格)</td></tr><tr><td><span class="codespan-content"><code>allocate(character(len=N))</code></span></td><td>动态分配长度为 N 的字符串</td></tr></tbody></table><h2 id="总结">总结</h2><table><thead><tr><th>场景</th><th>方法</th><th>示例</th></tr></thead><tbody><tr><td>简单拼接</td><td><span class="codespan-content"><code>//</code></span> 操作符</td><td><span class="codespan-content"><code>str1 // str2</code></span></td></tr><tr><td>动态长度</td><td>可分配字符串</td><td><span class="codespan-content"><code>character(len=:), allocatable</code></span></td></tr><tr><td>格式化拼接</td><td><span class="codespan-content"><code>write</code></span> 内部文件</td><td><span class="codespan-content"><code>write(str, &#39;(A,I2)&#39;) &quot;Age: &quot;, age</code></span></td></tr><tr><td>数组合并</td><td>循环或隐式循环</td><td><span class="codespan-content"><code>(trim(words(i)), i=1, 3)</code></span></td></tr><tr><td>避免截断</td><td>预分配空间</td><td><span class="codespan-content"><code>allocate(character(len=N))</code></span></td></tr></tbody></table><div class="container fullwidth" style="justify-items: end; text-align: end;"><p><a href="https://qinguoming.pages.dev/">返回 主页</a></p></div></main>
    <aside class="margin-area" id="margin-area-right"></aside>
  </body>
</html>
